trigger:
  branches:
    include:
      - main

variables:
  # Container registry service connection established during pipeline creation
  containerRegistry: 'churchbotregistry.azurecr.io'
  dockerfilePath: '**/Dockerfile'
  tag: '$(Build.BuildId)'

pool:
  vmImage: ubuntu-latest

steps:
  - task: AzureContainerApps@1
    inputs:
      appSourcePath: '$(Build.SourcesDirectory)/ChurchDiscordBot'
      azureSubscription: 'Visual Studio Enterprise Subscription â€“ MPN(a42da27c-dc48-4347-a7af-02afda3255cd)'
      acrName: 'churchbotregistry.azurecr.io'
      containerAppName: 'churchbotcontainerapp'
      resourceGroup: 'churchbotrg'
      ingress: 'internal'